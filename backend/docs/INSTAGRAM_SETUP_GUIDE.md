# üì∏ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Instagram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üö® –í–ê–ñ–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï
**Instagram Basic Display API –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª –ø–æ–¥–¥–µ—Ä–∂–∫—É 4 –¥–µ–∫–∞–±—Ä—è 2024 –≥–æ–¥–∞!**

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –Ω–æ–≤—ã–π **Instagram API —á–µ—Ä–µ–∑ Facebook Graph API**.

## üéØ –¶–µ–ª—å
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Instagram API —á–µ—Ä–µ–∑ Facebook Graph API –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ Instagram Business/Creator –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –ø—Ä–æ—Ñ–∏–ª—é –≤ Farolero Loyalty App.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Facebook –∞–∫–∫–∞—É–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- **Instagram Business –∏–ª–∏ Creator –∞–∫–∫–∞—É–Ω—Ç** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- –î–æ–º–µ–Ω —Å HTTPS (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è production)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π backend —Å–µ—Ä–≤–µ—Ä

## ‚ö° –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–º API:
- –¢—Ä–µ–±—É–µ—Ç Instagram Business/Creator –∞–∫–∫–∞—É–Ω—Ç (–Ω–µ –ª–∏—á–Ω—ã–π)
- **–ù–æ–≤—ã–µ scope values:** `instagram_basic`, `instagram_content_publish`, `instagram_manage_insights`
- **OAuth URL:** `https://www.facebook.com/v23.0/dialog/oauth` (–ù–ï Instagram!)
- –ë–æ–ª–µ–µ –º–æ—â–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞
- **–¢—Ä–µ–±—É–µ—Ç —Å–≤—è–∑—ã–≤–∞–Ω–∏—è —Å Facebook Page** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)

---

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Facebook for Developers

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Facebook for Developers**
   ```
   https://developers.facebook.com/
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" (Create App)
   - –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø: **"–î—Ä—É–≥–æ–µ"** (Other) - –í–ê–ñ–ù–û!
   - –ù–∞–∂–º–∏—Ç–µ "–î–∞–ª–µ–µ"
   - –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ç–∏–ø: **"–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π"** (Consumer)
   - –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: "Farolero Loyalty App"
   - –í–≤–µ–¥–∏—Ç–µ email –¥–ª—è —Å–≤—è–∑–∏

3. **–î–æ–±–∞–≤—å—Ç–µ Instagram API**
   
   **–ú–µ—Ç–æ–¥ 1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π):**
   - –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "–ü—Ä–æ–¥—É–∫—Ç—ã" (Products)
   - –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç" (Add Product)
   - –ù–∞–π–¥–∏—Ç–µ **"Instagram API"** (–ù–ï Basic Display!)
   - –ù–∞–∂–º–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å" (Set up)

   **–ú–µ—Ç–æ–¥ 2 (–ø–æ–∏—Å–∫):**
   - –í –ø–æ–∏—Å–∫–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤–≤–µ–¥–∏—Ç–µ "Instagram API"
   - –í—ã–±–µ—Ä–∏—Ç–µ "Instagram API" (–æ—Å–Ω–æ–≤–Ω–æ–π API, –Ω–µ Basic Display)

   **‚ö†Ô∏è –í–ê–ñ–ù–û:** –ù–ï –≤—ã–±–∏—Ä–∞–π—Ç–µ "Instagram Basic Display" - –æ–Ω —É—Å—Ç–∞—Ä–µ–ª!

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Instagram API

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Instagram API**
   - –í —Ä–∞–∑–¥–µ–ª–µ "Instagram API" ‚Üí "Basic Display"
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è:
     - **Valid OAuth Redirect URIs:**
       ```
       https://api.5425685-au70735.twc1.net/api/instagram/callback
       ```
     - **Deauthorize Callback URL:**
       ```
       https://api.5425685-au70735.twc1.net/api/instagram/deauth
       ```
     - **Data Deletion Request URL:**
       ```
       https://api.5425685-au70735.twc1.net/api/instagram/delete
       ```

2. **–ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
   - **Facebook App ID** - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - **Facebook App Secret** - –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å" —Ä—è–¥–æ–º —Å App Secret

### –®–∞–≥ 3: –°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å Facebook Page

1. **–°–æ–∑–¥–∞–π—Ç–µ Facebook Page** (–µ—Å–ª–∏ –Ω–µ—Ç)
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://www.facebook.com/pages/create
   - –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞

2. **–°–≤—è–∂–∏—Ç–µ Instagram —Å Facebook Page**
   - –í Instagram: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ê–∫–∫–∞—É–Ω—Ç ‚Üí –°–≤—è–∑–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã ‚Üí Facebook
   - –°–≤—è–∂–∏—Ç–µ Instagram Business/Creator –∞–∫–∫–∞—É–Ω—Ç —Å Facebook Page

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. **–î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
   - –í —Ä–∞–∑–¥–µ–ª–µ "Roles" ‚Üí "Instagram Testers"
   - –î–æ–±–∞–≤—å—Ç–µ Instagram –∞–∫–∫–∞—É–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ

2. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã**
   - –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–æ–π—Ç–∏ –≤ Instagram
   - –ü–µ—Ä–µ–π—Ç–∏ –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å–∞–π—Ç—ã
   - –ù–∞–π—Ç–∏ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–æ—Å—Ç—É–ø

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª `.env`:

```bash
# Instagram API Configuration (Facebook Graph API)
INSTAGRAM_APP_ID=1234567890123456        # Facebook App ID
INSTAGRAM_APP_SECRET=abcdef1234567890    # Facebook App Secret
INSTAGRAM_REDIRECT_URI=https://api.5425685-au70735.twc1.net/api/instagram/callback
```

### üîë –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- **INSTAGRAM_APP_ID** —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç Facebook App ID
- **INSTAGRAM_APP_SECRET** —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç Facebook App Secret
- **OAuth URL** –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `https://www.facebook.com/v23.0/dialog/oauth`
- **Scope** –æ–±–Ω–æ–≤–ª–µ–Ω: `instagram_basic,instagram_content_publish,instagram_manage_insights`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É:
```bash
node backend/scripts/check-instagram-setup.js
```

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ OAuth flow:
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π URL
curl "https://api.5425685-au70735.twc1.net/auth/instagram/login?tg_user_id=test_123"
```

### 3. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ Facebook OAuth (–ù–ï Instagram!)  
‚úÖ –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π Instagram  
‚úÖ –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞  

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "–Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞":
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** OAuth URL –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ Facebook Graph API
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** Scope –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ API
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** Token endpoint –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ Facebook

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è Instagram API:
- ‚úÖ Instagram Business/Creator –∞–∫–∫–∞—É–Ω—Ç
- ‚úÖ –°–≤—è–∑—å —Å Facebook Page
- ‚úÖ Facebook App —Å Instagram API –ø—Ä–æ–¥—É–∫—Ç–æ–º
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ Redirect URIs

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Facebook for Developers](https://developers.facebook.com/)
- [Instagram API Documentation](https://developers.facebook.com/docs/instagram-api/)
- [Facebook Graph API](https://developers.facebook.com/docs/graph-api/)

---

## üéØ –ì–æ—Ç–æ–≤–æ –∫–æ–≥–¥–∞
- [x] Facebook App —Å–æ–∑–¥–∞–Ω —Å Instagram API
- [x] Instagram Business/Creator –∞–∫–∫–∞—É–Ω—Ç —Å–≤—è–∑–∞–Ω —Å Facebook Page
- [x] Redirect URIs –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] .env –æ–±–Ω–æ–≤–ª–µ–Ω —Å Facebook App ID/Secret
- [x] OAuth flow —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Facebook (–ù–ï Instagram!)
- [x] –ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –ø—Ä–æ—Ñ–∏–ª—é
