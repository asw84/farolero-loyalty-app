# üéØ Farolero Loyalty App

> Telegram Mini App —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏ AmoCRM, VK, Instagram –∏ —Å–∏—Å—Ç–µ–º–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **üì± Telegram Mini App** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **üè¢ AmoCRM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –ª–æ—è–ª—å–Ω–æ—Å—Ç—å—é  
- **üîµ VK –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –ø—Ä–∏–≤—è–∑–∫–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π
- **üì∏ Instagram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Å–≤—è–∑—å —Å Instagram –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
- **üéØ –°–∏—Å—Ç–µ–º–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤** - —Å QR –∫–æ–¥–∞–º–∏ –∏ –±–æ–Ω—É—Å–∞–º–∏
- **üìä RFM –∞–Ω–∞–ª–∏–∑** - —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **üé´ Qtickets –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –ø—Ä–æ–¥–∞–∂–∞ –±–∏–ª–µ—Ç–æ–≤ –∏ –∫—ç—à–±–µ–∫
- **üîß –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –ø—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## üìä –°—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|-----------|------------|--------|
| üè¢ AmoCRM | 100% | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| üîµ VK | 100% | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| üíæ Backend | 98% | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| üé´ Qtickets | 90% | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| üì∏ Instagram | 75% | ‚ö†Ô∏è –ù—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ |
| üì± Telegram Bot | 80% | ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ |

**–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: 85%** - –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend
- **Node.js** + Express.js
- **SQLite3** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **JWT** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Axios** - HTTP –∫–ª–∏–µ–Ω—Ç

### Frontend  
- **React 19** + TypeScript
- **Vite** - —Å–±–æ—Ä—â–∏–∫
- **React Router DOM** - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- **CSS3** - —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **AmoCRM API** - CRM —Å–∏—Å—Ç–µ–º–∞
- **VK API** - —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
- **Instagram Basic Display API** - –º–µ–¥–∏–∞ –∫–æ–Ω—Ç–µ–Ω—Ç
- **Telegram Bot API** - –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **Qtickets API** - –ø—Ä–æ–¥–∞–∂–∞ –±–∏–ª–µ—Ç–æ–≤

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
git clone https://github.com/your-username/farolero-loyalty-app.git
cd farolero-loyalty-app
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp backend/.env.example backend/.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ backend/.env —Å –≤–∞—à–∏–º–∏ API –∫–ª—é—á–∞–º–∏
```

### 3. Docker –∑–∞–ø—É—Å–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
docker-compose up -d --build
```

### 4. –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
# Backend
cd backend
npm install
node test-db-simple.js  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
node server.js

# Frontend (–≤ –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd frontend  
npm install
npm run dev
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–µ–π

### AmoCRM (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
1. –ó–∞–π–¥–∏—Ç–µ –≤ https://your-domain.amocrm.ru/settings/integrations
2. –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ Client ID –∏ Client Secret
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `https://your-domain.com/auth/setup`

### VK (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ https://dev.vk.com/
2. –ü–æ–ª—É—á–∏—Ç–µ Client ID –∏ Client Secret
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Redirect URI: `https://your-domain.com/api/oauth/vk/callback`

### Instagram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ https://developers.facebook.com/
2. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–¥—É–∫—Ç "Instagram Basic Display"
3. –ü–æ–ª—É—á–∏—Ç–µ App ID –∏ App Secret

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
cd backend
node check-all-integrations.js
```

### –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
node test-quick.js

# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
node test-vk-integration.js
node test-instagram-integration.js

# –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
./test-deploy.sh
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö URL
```bash
node generate-vk-test-urls.js
node generate-instagram-test-urls.js
```

## üåê API Endpoints

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `GET /auth/vk/login?tg_user_id=123` - VK –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `GET /auth/instagram/login?tg_user_id=123` - Instagram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `GET /auth/setup` - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ AmoCRM

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `GET /api/users/:id` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/users` - —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /api/users/:id` - –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –†–µ—Ñ–µ—Ä–∞–ª—ã
- `POST /api/referral/generate` - —Å–æ–∑–¥–∞—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥
- `POST /api/referral/activate` - –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
- `GET /api/referral/stats/:id` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- `GET /api/analytics/rfm` - RFM —Å–µ–≥–º–µ–Ω—Ç—ã
- `POST /api/analytics/rfm/calculate` - –ø–µ—Ä–µ—Å—á–µ—Ç RFM
- `GET /api/analytics/dashboard` - –¥–∞–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥–∞

### –°–∏—Å—Ç–µ–º–∞
- `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `GET /api/test/db` - —Ç–µ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –ß–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
git clone https://github.com/your-username/farolero-loyalty-app.git
cd farolero-loyalty-app
cp backend/.env.example backend/.env
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ backend/.env
docker-compose up -d --build
```

### –ß–µ—Ä–µ–∑ PM2
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2
npm install -g pm2

# –ó–∞–ø—É—Å–∫ backend
cd backend
npm install
pm2 start server.js --name "farolero-backend"

# –ó–∞–ø—É—Å–∫ frontend
cd ../frontend
npm install
npm run build
pm2 serve dist 8080 --name "farolero-frontend"
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
farolero-loyalty-app/
‚îú‚îÄ‚îÄ üìÇ backend/                 # Node.js API —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ amocrm/             # AmoCRM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ controllers/        # API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ routes/             # Express –º–∞—Ä—à—Ä—É—Ç—ã  
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ services/           # –ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ tests/              # –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ database.js         # SQLite –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ server.js           # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ .env.example        # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ üìÇ frontend/               # React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ src/                # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ public/             # –°—Ç–∞—Ç–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ package.json        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ üìÇ scripts/                # –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ üìÇ docs/                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ docker-compose.yml      # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÑ .gitignore              # Git –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îî‚îÄ‚îÄ üìÑ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ `.env` (–Ω–µ –≤ Git)
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è OAuth
- ‚úÖ HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è production
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ Docker health checks

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- [VK_SETUP_GUIDE.md](VK_SETUP_GUIDE.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ VK –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [INSTAGRAM_SETUP_GUIDE.md](INSTAGRAM_SETUP_GUIDE.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Instagram
- [TESTING_GUIDE.md](TESTING_GUIDE.md) - –≥–∏–¥ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –°—Ç–∞—Ç—É—Å –∏ –æ—Ç—á–µ—Ç—ã
- [INTEGRATIONS_STATUS_REPORT.md](INTEGRATIONS_STATUS_REPORT.md) - —Å—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- [DEVELOPMENT_ROADMAP.md](docs/DEVELOPMENT_ROADMAP.md) - –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
2. –°–æ–∑–¥–∞–π—Ç–µ feature –≤–µ—Ç–∫—É (`git checkout -b feature/amazing-feature`)
3. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. –ó–∞–ø—É—à—å—Ç–µ –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–û—à–∏–±–∫–∞ "Module not found"**
   ```bash
   cd backend && npm install
   ```

2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è**
   ```bash
   node backend/test-db-simple.js
   ```

3. **VK –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
   ```bash
   node backend/test-vk-integration.js
   ```

### –ö–æ–Ω—Ç–∞–∫—Ç—ã
- üìß Email: support@farolero.com
- üí¨ Telegram: @farolero_support
- üêõ Issues: GitHub Issues

## üèÜ –ê–≤—Ç–æ—Ä—ã

- **Farolero Team** - *–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞* - [GitHub](https://github.com/farolero)

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- AmoCRM –∑–∞ –æ—Ç–ª–∏—á–Ω–æ–µ API
- VK –∑–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é  
- Instagram –∑–∞ –º–µ–¥–∏–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- Telegram –∑–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É Mini Apps
- Qtickets –∑–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ

---

**Made with ‚ù§Ô∏è by Farolero Team**